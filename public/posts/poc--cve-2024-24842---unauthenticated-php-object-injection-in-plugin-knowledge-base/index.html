<!doctype html><html lang=en dir=auto data-theme=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress | ancorn_</title><meta name=keywords content><meta name=description content="Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection
âœ‹ Table of content

About Knowledge Base for Documentation, FAQs with AI Assistance plugin
The security vulnerability
The patch
Conclusion

This blog post is about the Knowledge Base for Documentation, FAQs with AI Assistance plugin vulnerability. If you&rsquo;re using this plugin, please update the plugin to at least version 11.31.0.
About Knowledge Base for Documentation, FAQs with AI Assistance plugin
The plugin Knowledge Base for Documentation, FAQs with AI Assistance  (versions 11.30.2 and below), which is estimated to have over 10,000 active installations."><meta name=author content="ancorn_"><link rel=canonical href=http://localhost:1313/posts/poc--cve-2024-24842---unauthenticated-php-object-injection-in-plugin-knowledge-base/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.a29c24210eb31d9ce56f669c66a35c9c51b17376b7764e336a49af7dec914cf0.css integrity="sha256-opwkIQ6zHZzlb2acZqNcnFGxc3a3dk4zakmvfeyRTPA=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/poc--cve-2024-24842---unauthenticated-php-object-injection-in-plugin-knowledge-base/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="http://localhost:1313/posts/poc--cve-2024-24842---unauthenticated-php-object-injection-in-plugin-knowledge-base/"><meta property="og:site_name" content="ancorn_"><meta property="og:title" content="[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress"><meta property="og:description" content="Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection
âœ‹ Table of content About Knowledge Base for Documentation, FAQs with AI Assistance plugin The security vulnerability The patch Conclusion This blog post is about the Knowledge Base for Documentation, FAQs with AI Assistance plugin vulnerability. If youâ€™re using this plugin, please update the plugin to at least version 11.31.0.
About Knowledge Base for Documentation, FAQs with AI Assistance plugin The plugin Knowledge Base for Documentation, FAQs with AI Assistance (versions 11.30.2 and below), which is estimated to have over 10,000 active installations."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-19T21:24:25+07:00"><meta property="article:modified_time" content="2024-02-19T21:24:25+07:00"><meta property="og:image" content="https://pbs.twimg.com/profile_images/1634910718846963717/RJTIDn4s_400x400.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pbs.twimg.com/profile_images/1634910718846963717/RJTIDn4s_400x400.jpg"><meta name=twitter:title content="[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress"><meta name=twitter:description content="Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection
âœ‹ Table of content

About Knowledge Base for Documentation, FAQs with AI Assistance plugin
The security vulnerability
The patch
Conclusion

This blog post is about the Knowledge Base for Documentation, FAQs with AI Assistance plugin vulnerability. If you&rsquo;re using this plugin, please update the plugin to at least version 11.31.0.
About Knowledge Base for Documentation, FAQs with AI Assistance plugin
The plugin Knowledge Base for Documentation, FAQs with AI Assistance  (versions 11.30.2 and below), which is estimated to have over 10,000 active installations."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress","item":"http://localhost:1313/posts/poc--cve-2024-24842---unauthenticated-php-object-injection-in-plugin-knowledge-base/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress","name":"[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress","description":"Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection\nâœ‹ Table of content About Knowledge Base for Documentation, FAQs with AI Assistance plugin The security vulnerability The patch Conclusion This blog post is about the Knowledge Base for Documentation, FAQs with AI Assistance plugin vulnerability. If you\u0026rsquo;re using this plugin, please update the plugin to at least version 11.31.0.\nAbout Knowledge Base for Documentation, FAQs with AI Assistance plugin The plugin Knowledge Base for Documentation, FAQs with AI Assistance (versions 11.30.2 and below), which is estimated to have over 10,000 active installations.\n","keywords":[],"articleBody":"Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection\nâœ‹ Table of content About Knowledge Base for Documentation, FAQs with AI Assistance plugin The security vulnerability The patch Conclusion This blog post is about the Knowledge Base for Documentation, FAQs with AI Assistance plugin vulnerability. If youâ€™re using this plugin, please update the plugin to at least version 11.31.0.\nAbout Knowledge Base for Documentation, FAQs with AI Assistance plugin The plugin Knowledge Base for Documentation, FAQs with AI Assistance (versions 11.30.2 and below), which is estimated to have over 10,000 active installations.\nThis Knowledge Base plugin is a powerful documentation tool that helps you create and organize your documentation, FAQs, and articles.\nðŸ’£ The security vulnerability The Knowledge Base for Documentation, FAQs with AI Assistance plugin has been identified with an unauthenticated PHP Object Injection vulnerability. This vulnerability arises when user-input data is not adequately sanitized before being transmitted to the maybe_unserialize function, which serves as a wrapper for PHPâ€™s unserialize function.\nDue to PHPâ€™s capability to serialize objects, an unauthorized user could supply customized serialized strings to an exploitable unserialize call, leading to the injection of arbitrary PHP object(s) into the application scope. This specific vulnerability was addressed in version 11.31.0 and assigned the identifier CVE-2024-24842.\nThe root cause of the vulnerability lies within the is_article_recently_viewed function:\nThe is_article_recently_viewed function is invoked within the maybe_increase_article_count function to check if a user has recently viewed the article. Simultaneously, the maybe_increase_article_count function is called from the process_article_count function. However, the process_article_count function is invoked through the action epkb_count_article_view.\nIn the context of WordPress, if the prefixed action wp_ajax_nopriv is declared, this action can be invoked by unauthenticated user.\nConsequently, this allows an unauthenticated attacker to exploit the PHP Object Injection vulnerability through the following sequence of functions:\nInvoke the action epkb_count_article_view to trigger the process_article_count function \u003e maybe_increase_article_count \u003e is_article_recently_viewed \u003e maybe_unserialize \u003e trigger chain\nBy sending a request to trigger the epkb_count_article_view action with the epkb_article_views_counter cookie containing a serialized payload, it becomes possible to inject code effortlessly.\nTo obtain the nonce value to insert into the request, you can send request like this one:\nThe patch Since the issue is mainly because the plugin uses the unsafe maybe_unserialize function, replacing the function should be enough to fix the issue. In this case, the vendor decided to use the JSON format to process the $_COOKIE[â€™epkb_article_views_counterâ€™] data. The patch can be seen below:\nConclusion The maybe_unserialize function is a wrapper for PHP unserialize function which is one of the more sensitive processes that could lead to a security issue. In general, I am solely focused on searching for similar functions to identify multiple vulnerabilities like this one.\n","wordCount":"451","inLanguage":"en","image":"https://pbs.twimg.com/profile_images/1634910718846963717/RJTIDn4s_400x400.jpg","datePublished":"2024-02-19T21:24:25+07:00","dateModified":"2024-02-19T21:24:25+07:00","author":{"@type":"Person","name":"ancorn_"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/poc--cve-2024-24842---unauthenticated-php-object-injection-in-plugin-knowledge-base/"},"publisher":{"@type":"Organization","name":"ancorn_","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:1313/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;Â»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[POC] CVE-2024-24842 - Unauthenticated PHP Object Injection in plugin Knowledge Base - Wordpress</h1><div class=post-meta><span title='2024-02-19 21:24:25 +0700 +07'>February 19, 2024</span>&nbsp;Â·&nbsp;<span>3 min</span>&nbsp;Â·&nbsp;<span>451 words</span>&nbsp;Â·&nbsp;<span>ancorn_</span></div></header><div class=post-content><p><a href=https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/echo-knowledge-base/knowledge-base-for-documentation-faqs-with-ai-assistance-11302-unauthenticated-php-object-injection-in-is-article-recently-viewed>Knowledge Base for Documentation, FAQs with AI Assistance plugin - Unauthenticated PHP Object Injection</a></p><h2 id=-table-of-content>âœ‹ Table of content<a hidden class=anchor aria-hidden=true href=#-table-of-content>#</a></h2><ol><li>About Knowledge Base for Documentation, FAQs with AI Assistance plugin</li><li>The security vulnerability</li><li>The patch</li><li>Conclusion</li></ol><p>This blog post is about the <strong>Knowledge Base for Documentation, FAQs with AI Assistance</strong> plugin vulnerability. If you&rsquo;re using this plugin, please update the plugin to at least version <strong>11.31.0</strong>.</p><h2 id=about-knowledge-base-for-documentation-faqs-with-ai-assistance-plugin>About Knowledge Base for Documentation, FAQs with AI Assistance plugin<a hidden class=anchor aria-hidden=true href=#about-knowledge-base-for-documentation-faqs-with-ai-assistance-plugin>#</a></h2><p>The plugin <strong>Knowledge Base for Documentation, FAQs with AI Assistance</strong> (versions 11.30.2 and below), which is estimated to have over 10,000 active installations.</p><p><img alt=image loading=lazy src=/CVE-2024-24842/1.png></p><p>This <strong>Knowledge Base</strong> plugin is a powerful documentation tool that helps you create and organize your documentation, FAQs, and articles.</p><h2 id=-the-security-vulnerability>ðŸ’£ The security vulnerability<a hidden class=anchor aria-hidden=true href=#-the-security-vulnerability>#</a></h2><p>The <strong>Knowledge Base for Documentation, FAQs with AI Assistance</strong> plugin has been identified with an unauthenticated PHP Object Injection vulnerability. This vulnerability arises when user-input data is not adequately sanitized before being transmitted to the maybe_unserialize function, which serves as a wrapper for PHP&rsquo;s <strong>unserialize</strong> function.</p><p>Due to PHP&rsquo;s capability to serialize objects, an unauthorized user could supply customized serialized strings to an exploitable <strong>unserialize</strong> call, leading to the injection of arbitrary PHP object(s) into the application scope. This specific vulnerability was addressed in version <strong>11.31.0</strong> and assigned the identifier <strong><a href=https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/echo-knowledge-base/knowledge-base-for-documentation-faqs-with-ai-assistance-11302-unauthenticated-php-object-injection-in-is-article-recently-viewed>CVE-2024-24842</a></strong>.</p><p><img alt=image loading=lazy src=/CVE-2024-24842/2.png></p><p>The root cause of the vulnerability lies within the <strong>is_article_recently_viewed</strong> function:</p><p><img alt=image loading=lazy src=/CVE-2024-24842/3.png></p><p>The <strong>is_article_recently_viewed</strong> function is invoked within the <strong>maybe_increase_article_count</strong> function to check if a user has recently viewed the article. Simultaneously, the <strong>maybe_increase_article_count</strong> function is called from the <strong>process_article_count</strong> function. However, the <strong>process_article_count</strong> function is invoked through the action <strong>epkb_count_article_view</strong>.</p><p><img alt=image loading=lazy src=/CVE-2024-24842/4.png></p><p>In the context of WordPress, if the prefixed action <strong>wp_ajax_nopriv</strong> is declared, this action can be invoked by unauthenticated user.</p><p><img alt=image loading=lazy src=/CVE-2024-24842/5.png></p><p>Consequently, this allows an unauthenticated attacker to exploit the PHP Object Injection vulnerability through the following sequence of functions:</p><p>Invoke the action <strong>epkb_count_article_view</strong> to trigger the <strong>process_article_count</strong> function > <strong>maybe_increase_article_count</strong> > <strong>is_article_recently_viewed</strong> > <strong>maybe_unserialize</strong> > trigger chain</p><p>By sending a request to trigger the <strong>epkb_count_article_view</strong> action with the <strong>epkb_article_views_counter</strong> cookie containing a serialized payload, it becomes possible to inject code effortlessly.</p><p><img alt=image loading=lazy src=/CVE-2024-24842/6.png></p><p>To obtain the nonce value to insert into the request, you can send request like this one:</p><p><img alt=image loading=lazy src=/CVE-2024-24842/7.png></p><h2 id=the-patch>The patch<a hidden class=anchor aria-hidden=true href=#the-patch>#</a></h2><p>Since the issue is mainly because the plugin uses the unsafe <strong>maybe_unserialize</strong> function, replacing the function should be enough to fix the issue. In this case, the vendor decided to use the JSON format to process the <strong>$_COOKIE[&rsquo;epkb_article_views_counter&rsquo;]</strong> data. The patch can be seen below:</p><p><img alt=image loading=lazy src=/CVE-2024-24842/8.png></p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>The <strong>maybe_unserialize</strong> function is a wrapper for PHP unserialize function which is one of the more sensitive processes that could lead to a security issue. In general, I am solely focused on searching for similar functions to identify multiple vulnerabilities like this one.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/m%E1%BB%99t-line-regex-c%C6%A1-b%E1%BA%A3n-v%C3%A0-m%C3%ACnh-%C4%91%C3%A3-ki%E1%BA%BFm--nh%C6%B0-th%E1%BA%BF-n%C3%A0o/><span class=title>Next Â»</span><br><span>Má»™t line Regex cÆ¡ báº£n vÃ  mÃ¬nh Ä‘Ã£ kiáº¿m $$$$$ nhÆ° tháº¿ nÃ o</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=http://localhost:1313/>ancorn_</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>